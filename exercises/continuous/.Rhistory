setwd("~/Documents/coursework/Spring2017/phylometh/exercises/continuous")
setwd("~/CodonUsageBias/organisms/Lachancea")
type <- "mutation"
cerevisiae <- read.table(file = paste("results/cerevisiae/cerevisiae_", type, ".csv", sep=""), header = T, sep = ",", as.is=T)
paradoxus <- read.table(file = paste("results/paradoxus/paradoxus_", type, ".csv", sep=""), header = T, sep = ",", as.is=T)
mikatae <- read.table(file = paste("results/mikatae/mikatae_", type, ".csv", sep=""), header = T, sep = ",", as.is=T)
kudriavzevii <- read.table(file = paste("results/kudriavzevii/kudriavzevii_", type, ".csv", sep=""), header = T, sep = ",", as.is=T)
castelli <- read.table(file = paste("results/castelli/castelli_", type, ".csv", sep=""), header = T, sep = ",", as.is=T)
kluyveriM <- read.table(file = paste("results/kluyveriM/kluyveriM_", type, ".csv", sep=""), header = T, sep = ",", as.is=T)
polyspora <- read.table(file = paste("results/polyspora/polyspora_", type, ".csv", sep=""), header = T, sep = ",", as.is=T)
waltii <- read.table(file = paste("results/waltii/waltii_", type, ".csv", sep=""), header = T, sep = ",", as.is=T)
thermotolerans <- read.table(file = paste("results/thermotolerans/thermotolerans_", type, ".csv", sep=""), header = T, sep = ",", as.is=T)
rouxii <- read.table(file = paste("results/rouxii/rouxii_", type, ".csv", sep=""), header = T, sep = ",", as.is=T)
glabrata <- read.table(file = paste("results/glabrata/glabrata_", type, ".csv", sep=""), header = T, sep = ",", as.is=T)
gossypii <- read.table(file = paste("results/gossypii/gossypii_", type, ".csv", sep=""), header = T, sep = ",", as.is=T)
lactis <- read.table(file = paste("results/lactis/lactis_", type, ".csv", sep=""), header = T, sep = ",", as.is=T)
Lelo <- read.table(file = paste("results/rokas_seqs/Lelo_", type, ".csv", sep=""), header = T, sep = ",", as.is=T)
Cpar <- read.table(file = paste("results/rokas_seqs/Cpar_", type, ".csv", sep=""), header = T, sep = ",", as.is=T)
Cdub <- read.table(file = paste("results/rokas_seqs/Cdub_", type, ".csv", sep=""), header = T, sep = ",", as.is=T)
Calb <- read.table(file = paste("results/rokas_seqs/Calb_", type, ".csv", sep=""), header = T, sep = ",", as.is=T)
Ctro <- read.table(file = paste("results/rokas_seqs/Ctro_", type, ".csv", sep=""), header = T, sep = ",", as.is=T)
Psti <- read.table(file = paste("results/rokas_seqs/Psti_", type, ".csv", sep=""), header = T, sep = ",", as.is=T)
Cgui <- read.table(file = paste("results/rokas_seqs/Cgui_", type, ".csv", sep=""), header = T, sep = ",", as.is=T)
Clus <- read.table(file = paste("results/rokas_seqs/Clus_", type, ".csv", sep=""), header = T, sep = ",", as.is=T)
Dhan <- read.table(file = paste("results/rokas_seqs/Dhan_", type, ".csv", sep=""), header = T, sep = ",", as.is=T)
posteriors <- cbind(cerevisiae$Posterior, paradoxus$Posterior, mikatae$Posterior,
kudriavzevii$Posterior, castelli$Posterior, kluyveriM$Posterior, polyspora$Posterior,
waltii$Posterior, thermotolerans$Posterior, rouxii$Posterior, glabrata$Posterior,
gossypii$Posterior, lactis$Posterior, Lelo$Posterior, Cpar$Posterior, Cdub$Posterior, Calb$Posterior,
Ctro$Posterior, Dhan$Posterior, Clus$Posterior, Cgui$Posterior, Psti$Posterior)
gossypii <- read.table(file = paste("results/gossypii/gossypii_", type, ".csv", sep=""), header = T, sep = ",", as.is=T)
gossypii <- read.table(file = paste("results/gossypii/old/gossypii_", type, ".csv", sep=""), header = T, sep = ",", as.is=T)
posteriors <- cbind(cerevisiae$Posterior, paradoxus$Posterior, mikatae$Posterior,
kudriavzevii$Posterior, castelli$Posterior, kluyveriM$Posterior, polyspora$Posterior,
waltii$Posterior, thermotolerans$Posterior, rouxii$Posterior, glabrata$Posterior,
gossypii$Posterior, lactis$Posterior, Lelo$Posterior, Cpar$Posterior, Cdub$Posterior, Calb$Posterior,
Ctro$Posterior, Dhan$Posterior, Clus$Posterior, Cgui$Posterior, Psti$Posterior)
colnames(posteriors) <- c("Scer", "Spar", "Smik", "Skud", "Scas",
"Sklu", "Kpol", "Kwal", "Kthe", "Zrou",
"Cgla", "Agos", "Klac", "Lelo", "Cpar",
"Cdub", "Calb", "Ctro", "Dhan", "Clus",
"Cgui", "Psti")
head(posterior)
head(posteriors)
write.table(x = posteriors, file = "results/delta_M_means.csv", col.names = T, quote = F, row.names = F, sep = ",")
setwd("~/Documents/coursework/Spring2017/phylometh/exercises/continuous")
tree <- read.tree("~/CodonUsageBias/organisms/Lachancea/results/rokas_noBay_RAxML_bestTree_rooted.nwk")
library(ape) #utility fns
library(geiger) #utilty fns
library(OUwie)
tree <- read.tree("~/CodonUsageBias/organisms/Lachancea/results/rokas_noBay_RAxML_bestTree_rooted.nwk")
continuous.data <- read.csv(file="~/CodonUsageBias/organisms/Lachancea/results/delta_M_means.csv", stringsAsFactors=FALSE) #death to factors.
?treedata
CleanData <- function(phy, data) {
#treedata() in Geiger is probably my favorite function in R.
return(treedata(phy, data))
}
CleanData(tree, continuous.data)
continuous.data <- read.csv(file="~/CodonUsageBias/organisms/Lachancea/results/delta_M_means.csv", stringsAsFactors=FALSE, header=T) #death to factors.
(tree, continuous.data)
CleanData(tree, continuous.data)
View(continuous.data)
tree$tip.label
colnames(continuous.data)
treedata
t(continuous.data)
continuous.data <- t(continuous.data)
CleanData(tree, continuous.data)
?contMap
```{r, eval=FALSE}
VisualizeData <- function(phy, data) {
#Important here is to LOOK at your data before running it. Any weird values? Does it all make sense? What about your tree? Polytomies?
contMap(phy, data)
}
cleaned.data <- CleanData(tree, continuous.data)
VisualizeData(cleaned.data$, cleaned.data$data)
VisualizeData(cleaned.data$phy, cleaned.data$data)
VisualizeData <- function(phy, data) {
#Important here is to LOOK at your data before running it. Any weird values? Does it all make sense? What about your tree? Polytomies?
phytools::contMap(phy, data)
}
VisualizeData(cleaned.data$phy, cleaned.data$data)
VisualizeData(cleaned.data$phy, cleaned.data$data[,1])
BM1 <- geiger::fitContinuous(cleaned.data$phy, cleaned.data$data, model="BM")
?fitContinuous()
BM1 <- geiger::fitContinuous(cleaned.data$phy, cleaned.data$data[,1], model="BM")
BM1$res
cleaned.data$data[,1]
BM1$opt
BM1$opt$sigsq
OU1 <- fitContinuous(cleaned.data$phy, cleaned.data$data[,1], model="OU")
par(mfcol(c(1,2)))
par(mfcol=c(1,2))
plot(tree, show.tip.label=FALSE)
ou.tree <- rescale(tree, model="OU", OU1$opt$alpha)
plot(ou.tree)
par(mfcol=c(1,2))
plot(tree, show.tip.label=FALSE)
ou.tree <- rescale(tree, model="OU", OU1$opt$alpha)
plot(ou.tree, show.tip.label=FALSE)
OU1$opt$alpha
OU1 <- fitContinuous(cleaned.data$phy, cleaned.data$data[,1], model="OU")
par(mfcol=c(1,2))
plot(tree, show.tip.label=FALSE)
ou.tree <- rescale(tree, model="OU", OU1$opt$alpha)
plot(ou.tree, show.tip.label=FALSE)
ou.tree <- rescale(tree, model="OU", 20)
plot(ou.tree, show.tip.label=FALSE)
BM1$opt$aic
OU1$opt$aic
?ace
